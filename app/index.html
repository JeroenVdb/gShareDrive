<!doctype html>
<html lang="en" ng-app="myApp">
<head>
	<meta charset="utf-8">
	<title>My AngularJS App</title>
	<link rel="stylesheet" href="css/app.css"/>

	
	<script type="text/javascript">
		var CLIENT_ID = '204641009663-38031cihtno5io8o08h3f0odrli1oom4.apps.googleusercontent.com'; // localhost
		var SCOPES = [
		'https://www.googleapis.com/auth/drive',
		'https://www.googleapis.com/auth/drive.file',
		'https://www.googleapis.com/auth/userinfo.email',
		'https://www.googleapis.com/auth/userinfo.profile',
			  // Add other scopes needed by your application.
			  ];

		  /**
		   * Called when the client library is loaded.
		   */
		   function handleClientLoad() {
		   	checkAuth();
		   }

		  /**
		   * Check if the current user has authorized the application.
		   */
		   function checkAuth() {
		   	gapi.auth.authorize(
		   		{'client_id': CLIENT_ID, 'scope': SCOPES.join(' '), 'immediate': true},
		   		handleAuthResult);
		   }

		  /**
		   * Called when authorization server replies.
		   *
		   * @param {Object} authResult Authorization result.
		   */
		   function handleAuthResult(authResult) {
		   	if (authResult) {
		   		console.log("grated");
			  // Access token has been successfully retrieved, requests can be sent to the API

			  gapi.client.load('drive', 'v2', callback);

			} else {
			  // No access token could be retrieved, force the authorization flow.
			  console.log("lets try again");
			  gapi.auth.authorize(
			  	{'client_id': CLIENT_ID, 'scope': SCOPES, 'immediate': false},
			  	handleAuthResult);
			}
		}

		function callback() {

					request = gapi.client.drive.files.list({
			          'q': "title = 'Share'"
			        });

			        request.execute(function(resp) {
					    console.log(resp);
					    console.log(resp.items[0].id)

					    id = resp.items[0].id;

					    request2 = gapi.client.drive.children.list({
				          'folderId' : id
				        }); 

				        request2.execute(function(resp) {
				        	for(var i = 0; i < resp.items.length; i++) {
				        		

				        		var request3 = gapi.client.drive.files.get({
								    'fileId': resp.items[i].id
								  });
								  request3.execute(function(resp) {
								    console.log('Title: ' + resp.thumbnailLink);

								    if (resp.hasOwnProperty('thumbnailLink')) {

									    var img = new Image();  ///params are optional 
										img.src = resp.thumbnailLink;
										document.body.appendChild(img)
								    }

								  });



				        	}
				        });


					});
		}


	</script>
</head>
<body>
	update 1
	<ul class="menu">
		<li><a href="#/view1">view1</a></li>
		<li><a href="#/view2">view2</a></li>
	</ul>

	<div ng-view></div>

	<div id="jeroen"></div>

	<div>Angular seed app: v<span app-version></span></div>

  <!-- In production use:
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/x.x.x/angular.min.js"></script>
-->
<script src="lib/angular/angular.js"></script>
<script src="lib/angular/angular-route.js"></script>
<script src="js/app.js"></script>
<script src="js/services.js"></script>
<script src="js/controllers.js"></script>
<script src="js/filters.js"></script>
<script src="js/directives.js"></script>

<script type="text/javascript" src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
</body>
</html>
